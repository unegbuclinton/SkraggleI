stages:
  - deploy
  - build

build:
  script:
    - npm install --save-dev --save-exact prettier
    - npx prettier --check .

deploy:
  image: alpine:latest
  stage: deploy
  script:
    - chmod 600 $IDRSA
    - apk update
    - apk add --update yarn openssh-client
    - yarn install
    - yarn build
    - ssh -i $IDRSA -o StrictHostKeyChecking=no $SKRAGGLE_USER@$SKRAGGLE_HOST "rm -rf ~/build/*"
    - scp -i $IDRSA -o StrictHostKeyChecking=no -r build/* $SKRAGGLE_USER@$SKRAGGLE_HOST:~/build/
  only:
    - develop